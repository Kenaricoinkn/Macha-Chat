<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>MACHA CHAT ‚Äî Masuk</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { brand:'#7C9BFF', brand2:'#A07CFF', dark:'#0b1020' } } }
    }
  </script>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body{font-family:'Inter',sans-serif;background:radial-gradient(circle at 20% 20%,#131b3a,#0b1020 80%);overflow-x:hidden}
    .card{background:rgba(20,25,50,.55);backdrop-filter:blur(12px);border:1px solid rgba(120,150,255,.2);box-shadow:0 0 25px rgba(124,155,255,.2);border-radius:1rem;transform-style:preserve-3d;transition:transform .2s ease,box-shadow .2s ease}
    .card:hover{transform:rotateX(6deg) rotateY(-6deg) scale(1.02);box-shadow:0 0 40px rgba(124,155,255,.35)}
    .input{background-color:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:.5rem;padding:.65rem .9rem;width:100%;transition:border-color .2s,box-shadow .2s}
    .input:focus{border-color:#7C9BFF;box-shadow:0 0 8px #7C9BFF55;outline:none}
    .btn-primary{background:linear-gradient(90deg,#7C9BFF,#A07CFF);color:#fff;font-weight:600;border-radius:.5rem;padding:.65rem;transition:transform .2s,box-shadow .2s;box-shadow:0 0 15px rgba(124,155,255,.3)}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 0 25px rgba(160,124,255,.4)}
    .toggle-eye{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:transparent;cursor:pointer;opacity:.6}
    #toast{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);background:rgba(255,60,60,.95);color:#fff;padding:.75rem 1.2rem;border-radius:.5rem;font-size:.875rem;box-shadow:0 0 15px rgba(255,60,60,.4);opacity:0;pointer-events:none;transition:opacity .4s ease,transform .4s ease;z-index:100}
    #toast.show{opacity:1;pointer-events:auto;transform:translateX(-50%) translateY(-6px)}
  </style>
</head>

<body class="min-h-screen text-slate-100 flex flex-col justify-center">

  <header class="px-6 py-5 text-center">
    <h1 class="text-3xl sm:text-4xl font-extrabold tracking-wider bg-gradient-to-r from-brand via-brand2 to-pink-500 text-transparent bg-clip-text drop-shadow-[0_0_10px_rgba(124,155,255,0.4)]">
      MACHA CHAT
    </h1>
  </header>

  <main class="px-6 pb-16">
    <div class="max-w-md mx-auto card p-6 md:p-8">
      <section id="panel-email" class="grid gap-3">
        <label class="text-sm">Email</label>
        <input id="email" type="email" class="input" placeholder="nama@email.com" autocomplete="email"/>

        <label class="mt-2 text-sm">Kata sandi</label>
        <div class="relative">
          <input id="password" type="password" class="input w-full pr-12" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password"/>
          <button id="togglePass" type="button" class="toggle-eye">üëÅÔ∏è</button>
        </div>

        <button id="btnEmail" class="btn-primary mt-4">Masuk</button>

        <p class="text-sm text-slate-300 mt-3 text-center">
          Belum punya akun?
          <a id="linkToRegisterEmail" class="underline text-brand hover:text-brand2" href="./register.html">Daftar</a>
        </p>
      </section>
    </div>
  </main>

  <p class="max-w-md mx-auto text-center text-xs text-slate-400 mt-4">
    Dengan masuk, Anda menyetujui ketentuan layanan kami.
  </p>

  <div id="toast"></div>

  <!-- Firebase Login -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    // üî• Firebase config kamu
    const firebaseConfig = {
      apiKey: "AIzaSyDIsTmg0_-rcz9tH3U-_sZuWk7sUOLgMSw",
      authDomain: "macha-chat.firebaseapp.com",
      projectId: "macha-chat",
      storageBucket: "macha-chat.firebasestorage.app",
      messagingSenderId: "576142384286",
      appId: "1:576142384286:web:cfed000ac8a50b662a6f8f",
      measurementId: "G-6ZMFHMZVEK"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const emailInput = document.getElementById("email");
    const passInput = document.getElementById("password");
    const btn = document.getElementById("btnEmail");
    const toast = document.getElementById("toast");

    function showToast(msg, color = "rgba(255,60,60,0.95)") {
      toast.textContent = msg;
      toast.style.background = color;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), 2500);
    }

    // üëÅÔ∏è Toggle password
    document.getElementById("togglePass").addEventListener("click", () => {
      const isHidden = passInput.type === "password";
      passInput.type = isHidden ? "text" : "password";
      togglePass.textContent = isHidden ? "üôà" : "üëÅÔ∏è";
    });

    // ‚úÖ Auto redirect jika sudah login
    onAuthStateChanged(auth, (user) => {
      if (user) {
        window.location.href = "./dashboard.html";
      }
    });

    // üîê Login Firebase
    btn.addEventListener("click", async () => {
      const email = emailInput.value.trim();
      const password = passInput.value.trim();

      if (!email || !password) return showToast("‚ö†Ô∏è Harap isi semua kolom!");

      try {
        await signInWithEmailAndPassword(auth, email, password);
        showToast("‚úÖ Login berhasil!", "rgba(0,200,100,0.9)");
        setTimeout(() => window.location.href = "./dashboard.html", 1000);
      } catch (err) {
        console.error(err);
        if (err.code === "auth/user-not-found") showToast("‚ùå Akun belum terdaftar!");
        else if (err.code === "auth/wrong-password") showToast("üîí Kata sandi salah!");
        else if (err.code === "auth/invalid-email") showToast("üìß Format email tidak valid!");
        else showToast("‚ö†Ô∏è Gagal login. Coba lagi.");
      }
    });
  </script>
</body>
</html>
