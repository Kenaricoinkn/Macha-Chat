<!doctype html><html lang="id"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Reels — MACHA CHAT</title>
<script src="https://cdn.tailwindcss.com"></script>
</head><body class="bg-slate-900 text-slate-100">
<header class="p-3 border-b border-white/10"><a href="./dashboard.html">← Kembali</a></header>
<main class="max-w-[600px] mx-auto p-3 space-y-4" id="list"></main>
<script type="module">
import { auth, db } from './js/config.js'
import { onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js'
import { collection, query, where, orderBy, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js'
const cld=(u)=>u?.includes('/upload/')?u.replace('/upload/','/upload/w_640,q_auto,f_auto/'):u
onAuthStateChanged(auth, user=>{
  if(!user){ location.replace('./index.html'); return }
  const list=document.getElementById('list')
  const q=query(collection(db,'posts'), where('videoURL','!=',''), orderBy('videoURL'), orderBy('createdAt','desc'))
  onSnapshot(q,s=>{
    list.innerHTML=''
    s.forEach(d=>{
      const p=d.data()
      const el=document.createElement('article')
      el.className='rounded-3xl border border-white/10 bg-slate-800/60 overflow-hidden'
      el.innerHTML=`<video src="${cld(p.videoURL)}" controls playsinline preload="metadata" class="w-full bg-black"></video>
                    ${p.text?`<div class="p-3">${p.text}</div>`:''}`
      list.appendChild(el)
    })
  })
})
</script>
</body></html>
